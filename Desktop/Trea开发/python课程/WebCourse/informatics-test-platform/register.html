<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注册 - 延安科创升学网</title>
    <link rel="stylesheet" href="src/styles/main.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <h2>延安科创升学网</h2>
                <p>创建您的账户</p>
            </div>

            <form id="registerForm" class="needs-validation" novalidate>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="firstName" class="form-label">
                            <i class="fas fa-user me-2"></i>姓氏
                        </label>
                        <input type="text" class="form-control" id="firstName" required>
                        <div class="invalid-feedback">请输入您的姓氏</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="lastName" class="form-label">名字</label>
                        <input type="text" class="form-control" id="lastName" required>
                        <div class="invalid-feedback">请输入您的名字</div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="email" class="form-label">
                        <i class="fas fa-envelope me-2"></i>邮箱地址
                    </label>
                    <input type="email" class="form-control" id="email" required>
                    <div class="invalid-feedback">请输入有效的邮箱地址</div>
                </div>

                <div class="mb-3">
                    <label for="phone" class="form-label">
                        <i class="fas fa-phone me-2"></i>手机号码
                    </label>
                    <input type="tel" class="form-control" id="phone" pattern="[0-9]{11}" required>
                    <div class="invalid-feedback">请输入11位手机号码</div>
                </div>

                <div class="mb-3">
                    <label for="password" class="form-label">
                        <i class="fas fa-lock me-2"></i>密码
                    </label>
                    <input type="password" class="form-control" id="password" 
                           pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$" required>
                    <div class="invalid-feedback">
                        密码必须包含大小写字母和数字，且长度至少8位
                    </div>
                    <div class="form-text">
                        密码需包含大小写字母和数字，至少8位字符
                    </div>
                </div>

                <div class="mb-3">
                    <label for="confirmPassword" class="form-label">
                        <i class="fas fa-lock me-2"></i>确认密码
                    </label>
                    <input type="password" class="form-control" id="confirmPassword" required>
                    <div class="invalid-feedback">两次输入的密码不一致</div>
                </div>

                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="agreeTerms" required>
                    <label class="form-check-label" for="agreeTerms">
                        我已阅读并同意 <a href="#" class="text-primary">服务条款</a> 和 <a href="#" class="text-primary">隐私政策</a>
                    </label>
                    <div class="invalid-feedback">请同意服务条款</div>
                </div>

                <button type="submit" class="btn btn-primary w-100 py-2">
                    <i class="fas fa-user-plus me-2"></i>注册账户
                </button>

                <div class="text-center mt-3">
                    <p>已有账户？ <a href="login.html" class="text-primary">立即登录</a></p>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="src/js/main.js"></script>
    <script>
        // 表单验证
        document.addEventListener('DOMContentLoaded', function() {
            // 确保authManager全局可用
            if (!window.authManager) {
                window.authManager = new AuthManager();
            }
            
            // 初始化应用
            try {
                App.init();
                console.log('注册页面初始化完成');
            } catch (error) {
                console.error('应用初始化失败:', error);
            }
            const form = document.getElementById('registerForm');
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirmPassword');

            // 密码确认验证
            confirmPassword.addEventListener('input', function() {
                if (password.value !== confirmPassword.value) {
                    confirmPassword.setCustomValidity('两次输入的密码不一致');
                } else {
                    confirmPassword.setCustomValidity('');
                }
            });

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                
                if (!form.checkValidity()) {
                    event.stopPropagation();
                    form.classList.add('was-validated');
                    return;
                }

                // 注册成功，保存用户数据
                const formData = {
                    firstName: document.getElementById('firstName').value,
                    lastName: document.getElementById('lastName').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    registerTime: new Date().toISOString()
                };

                // 保存用户信息
                if (window.authManager) {
                    window.authManager.saveUser(formData);
                    // 显示成功消息
                    alert('注册成功！欢迎 ' + formData.firstName + ' ' + formData.lastName);
                    
                    // 跳转到登录页面
                    setTimeout(function() {
                        window.location.href = 'login.html';
                    }, 1000);
                } else {
                    alert('系统错误：认证管理器未初始化');
                }
            });

            // 实时验证
            form.addEventListener('input', function(event) {
                const input = event.target;
                if (input.checkValidity()) {
                    input.classList.remove('is-invalid');
                    input.classList.add('is-valid');
                } else {
                    input.classList.remove('is-valid');
                    input.classList.add('is-invalid');
                }
            });
        });
    </script>
</body>
</html>